# lib.cxx.tinyxml2

load_module('lang.cxx.*')

tinyxml2 = Framework('tinyxml2',
 include = [loader.directory]
)

obj = cpp_compile(
  sources = [path.join(loader.directory, 'tinyxml2.cpp')],
  frameworks = [tinyxml2]
)

lib = cxx_library(
  inputs = [obj],
  output = 'tinyxml2',
)

tinyxml2['external_libs'] = [lib.metadata['link_target']]
tinyxml2['implicit_deps'] = [lib]

if options.build_main:
  main_bin = cxx_binary(
    inputs = [cpp_compile(
      sources = [local('main.cpp')],
      frameworks = [tinyxml2]
    )],
    output = 'main'
  )
  main = gentarget([[main_bin]], explicit=True)
